{% load static%}
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{% static 'home/css/home.css'%}">
</head>
<body>

<nav class="topnav">
  <a style="width:107px;" href="{% url 'Home' %}"><img src="https://www.scivale.com.br/wp-content/uploads/2017/12/logo-sci.png" alt="logo-sci"></a>
  <a href="{%url 'ComecarCompra'%}">Realizar Compra</a>
  <a href="{% url 'MostrarColab' %}">Colaboradores</a>
  <a href="{% url 'ListarProdu' %}">Produtos</a>
  <a href="{% url 'GerarRelatorio' %}">Relatórios</a>
  <a href="{% url 'ListarEstoque' %}">Estoque</a>
  <a href="{% url 'ListarMovimentacoes'%}">Movimentações</a>
  {% if user.is_superuser %}
          <a href="{% url 'ListarUser'%}">Usuários</a>
  {% endif %}
  <a class="logout" href="{%url 'Logout' %}">Sair -></a>

</nav>

<div class="linha">
    <table class="tabela-compradores">
    <thead class="thead-light">
      <tr>
        <th scope="col">Colaborador</th>
        <th scope="col">Total gasto</th>
      </tr>
    </thead>
    <tbody>
        {% for item in maiores_compradores %}
      <tr>
        {% if item.colaborador_id.nome|length > 20 %}
        <td>{{item.colaborador_id.nome|slice:":20" }}...</td>
        {%else%}
          <td>{{item.colaborador_id.nome}}</td>
        {%endif%}
        <td>R${{item.total_compras}}</td>
      {%endfor%}

    </tbody>
  </table>

  <div class="estoque">
        <div class="estoque-content" style="text-align: center;border:0px solid grey;">
          <h1>Estoque</h1>
          <a href="{% url 'ListarEstoque' %}">
          <table class="tabela-estoque">
            <thead class="thead-light">
              <tr>
                <th scope="col">Produto</th>
                <th scope="col">Quantidade</th>
              </tr>
            </thead>
            <tbody>
                {% for item in estoque %}
              <tr>
                {% if item.produto.nome|length > 45%}
                
                  <td>{{item.produto.nome|slice:":45"}}...</td>
                {%else%}
                <td>{{item.produto.nome}}</td>
                {%endif%}
                  {%if item.quantidade == 0%}
                  <td class="situacao-vermelho">{{item.quantidade}}</td>
                  {% elif item.quantidade > -100%}
                  <td class="situacao-amarelo">{{item.quantidade}}</td>
                  {%endif%}
              </tr>
              {%endfor%}
        
            </tbody>
          </table>
          </a>
        </div>
  </div>




  <div id="chartContainer" style="width: 400px; height: 400px;justify-content: center;position:relative;left: 0%;">
    <canvas id="myChart" class="graf-pizza" ></canvas>
  </div>

</div>
<br><br> 




<br><br>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // Obtém os valores do contexto passados pela view
  var valor1 = "{{ compras_mensal }}";
  var valor2 = '{{ compras_ultima_ref }}';

  // Dados do gráfico
  var data = {
    labels: ['Compras desse mês', 'Compras do último mês'],
    datasets: [{
      data: [valor1, valor2],
      backgroundColor: ['#FF6384', '#36A2EB'],
      color:'black'
    }]
  };

  // Configuração do gráfico
  var options = {
    responsive: true,  // Torna o gráfico responsivo para se ajustar ao contêiner
    maintainAspectRatio: false,  // Permite que o gráfico ocupe todo o espaço do contêiner
    legend: {
      position: 'bottom',  // Posição da legenda (top, bottom, left, right)
    },
    aspectRatio: 2,  // Define a relação de aspecto (largura:altura)

    layout: {
      padding: {
        top: 20,   // Espaçamento superior
        left: 50,  // Espaçamento esquerdo
        right: 50, // Espaçamento direito
        bottom: 20 // Espaçamento inferior
      }
    }
  };

  // Criação do gráfico de pizza
  var ctx = document.getElementById('myChart').getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'pie',
    data: data,
    options: options
  });
</script>
</body>
</html>

</body>
</html>